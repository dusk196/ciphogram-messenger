<section class="hero is-fullheight">
  <main></main>
  <footer class="footer">lol</footer>
</section>
<div class="is-hidden msg-container">
  <header>
    <div class="left">
      <h1 class="is-size-1 is-size-3-mobile">MAZE - Be Amazed! {{counter}}</h1>
      <div class="roomDetails">
        <h3>Room ID: {{roomId}}</h3>
        <button type="button" class="copy tooltip" (click)="onCopy()" (mouseenter)="onMouseEnter()">
          <span class="d-none">copy new room id</span>
          <span class="tooltip-text tooltip-msg" [innerText]="copyText"></span>
        </button>
      </div>
    </div>
    <div class="right">
      <button *ngIf="!isProdMode" type="button" class="switch tooltip" [ngClass]="isEncrypted ? 'on':'off'"
        (click)="isEncrypted = !isEncrypted">
        <span class="d-none">toggle encryption</span>
        <span class="tooltip-text tooltip-msg" [innerText]="isEncrypted?'Show decrypted!':'Show encrypted!'"></span>
      </button>
      <button type="button" [routerLink]="'/home'">Exit</button>
    </div>
  </header>
  <main>
    <div class="left" #chatContainer>
      <div class="top">
        <div class="chat-wrapper" *ngFor="let msg of allMessages">
          <div *ngIf="msg.intendedRecipientId === localUser.id"
            [ngClass]="msg.createdBy === localUser.id ?'chat-right': 'chat-left'">
            <p class="name" [innerText]="isEncrypted ? msg.createdBy : msg.createdBy | userById: allConnectedUsers"></p>
            <div
              [innerText]="isEncrypted ? msg.secretMessage : ((msg.secretMessage | decryptMsgs) || 'ALERT: Unable to decrypt!')">
            </div>
            <p class="time">{{msg.createdAt | date:'h:mm a, dd MMM yyyy'}}</p>
          </div>
        </div>
      </div>
      <div class="bottom">
        <div class="text-container">
          <textarea title="msg" class="text" [placeholder]="placeholderText" [(ngModel)]="message"
            (keyup.enter)="sendMessage()" maxlength="2000" autofocus></textarea>
          <button type="button" class="send" (click)="sendMessage()">
            <span class="d-none">send</span>
          </button>
        </div>
      </div>
    </div>
    <div class="right">
      <div class="list">
        <div class="status">
          <h3>Online: {{allConnectedUsers.length}}</h3>
          <ul>
            <li *ngFor="let user of allConnectedUsers">
              <span [ngClass]="{'bold': user.id === localUser.id}"
                [innerText]="isEncrypted ? user.id : user.name"></span>
            </li>
          </ul>
        </div>
        <div class="alias-container">
          <p>You've connected as:</p>
          <input class="" type="text" placeholder="Update Alias (required)" [(ngModel)]="aliasFormData" maxlength=30 />
          <div class="btns">
            <button type="button" class="" (click)="updateAlias()"
              [disabled]="aliasFormData.length === 0">Update</button>
            <button type="button" class="" (click)="generateAlias()">Random</button>
          </div>
        </div>
      </div>
    </div>
  </main>
  <footer>
    <footer>
      <p>
        Made with ❤️ by Sayantan Roy. Source code:
        <a rel="noopener" href="https://github.com/dusk196/maze-messenger" target="_blank">GitHub</a>
      </p>
    </footer>
  </footer>
</div>
<app-modal [modalDetails]="modalDetails" (closeModalEvent)="closeModal()"></app-modal>
